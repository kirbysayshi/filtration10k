(function(){function q(){var b=Math.random();this.n=b>0.9?true:false;this.b=100*b;this.r=this.b*this.b;this.s=this.n?99:100*b;this.d=a.c(0,0,0);this.a=a.c(0,0,0);this.f=a.c(0,0,0);this.e=1/this.b;this.p=[];this.k=1}q.prototype={};var a={i:false,h:function(){a.h=typeof Float32Array!=="undefined"?Float32Array:Array;a.i=true},c:function(b,d,j){a.i==false&&a.h();var i=new a.h(3);i[0]=b;i[1]=d;i[2]=j;return i},add:function(b,d){return a.c(b[0]+d[0],b[1]+d[1],b[2]+d[2])},sub:function(b,d){return a.c(b[0]-
d[0],b[1]-d[1],b[2]-d[2])},normalize:function(b){var d=b[0],j=b[1];b=b[2];var i=Math.sqrt(d*d+j*j+b*b);if(i){if(i==1)return a.c(d,j,b)}else return a.c(0,0,0);i=1/i;return a.c(d*i,j*i,b*i)},length:function(b){var d=b[0],j=b[1];b=b[2];return Math.sqrt(d*d+j*j+b*b)},g:function(b,d){return b[0]*d[0]+b[1]*d[1]+b[2]*d[2]},scale:function(b,d){return a.c(b[0]*d,b[1]*d,b[2]*d)},j:function(b){return a.c(b[0],b[1],b[2])}},r=new (function(b){b=document.getElementById(b);for(var d=[b.width,b.height,0],j=b.getContext("2d"),
i=15*Math.random(),k=[],s=0;s<i;s++){var n=Math.random(),o=Math.random(),m=new q;n*=d[0];o*=d[1];n=n>d[0]-m.b?n-=m.b:n;n=n<m.b?n+=m.b:n;o=o>d[1]-m.b?o-=m.b:o;o=o<m.b?o+=m.b:o;m.a=a.c(n,o,0);m.d=a.c(n,o,0);m.f=a.c(0,0,0);k.push(m)}i=new q;i.a=a.c(400,100,0);i.d=a.c(400,100,0);k.push(i);i=new q;i.a=a.c(100,100,0);i.d=a.c(100,100,0);k.push(i);var p=false;b.addEventListener("mousedown",function(f){var h=999999999,c=a.c(f.clientX,f.clientY,0);console.log(f,c);for(f=0;f<k.length;f++){var e=a.length(a.sub(c,
k[f].a));if(e<h){p=k[f];h=e}}},false);b.addEventListener("mouseup",function(){p=false},false);b.addEventListener("mousemove",function(f){if(p!=false){p.a[0]=f.clientX;p.a[1]=f.clientY;p.d[0]=f.clientX;p.d[1]=f.clientY}},false);return{l:function(){j.fillStyle="#000000";j.fillRect(0,0,d[0],d[1]);for(var f={},h=0;h<k.length;h++){f=k[h];j.fillStyle="rgba("+Math.floor(f.k*255)+",0,0,"+(1-f.a[2]/200)+")";j.strokeStyle=j.beginPath();j.arc(f.a[0],f.a[1],f.b,0,Math.PI*2,false);j.fill()}j.fillStyle="#FFFFFF";
j.fillText(MM(60)[0],100,20)},q:k,m:function(f){for(var h=0;h<k.length;h++){var c=k[h],e=a.j(c.a);c.a=a.add(a.add(a.sub(c.a,c.d),a.scale(c.f,f*f)),c.a);c.d=e;c.f=a.c(0,0,0);c=c;e=a.c(0,0,0);var g=0;if(c.a[0]<0+c.b){e[0]=c.a[0];e[1]=0;g=Math.abs(c.a[0]-c.b)}if(c.a[0]>d[0]-c.b){e[0]=c.a[0]-d[0];e[1]=0;g=Math.abs(c.a[0]-d[0]+c.b)}if(c.a[1]<0+c.b){e[0]=0;e[1]=c.a[1];g=Math.abs(c.a[1]-c.b)}if(c.a[1]>d[1]-c.b){e[0]=0;e[1]=c.a[1]-d[1];g=Math.abs(c.a[1]-d[1]+c.b)}if(!(g<=0)){e=a.normalize(e);c.a=a.add(c.a,
a.scale(e,g));g=a.sub(c.a,c.d);e=a.scale(e,a.g(g,e));e=a.sub(g,e);c.a=a.sub(c.a,a.scale(e,0.5))}}},o:function(){for(var f=0;f<k.length;f++)for(var h=k[f],c=0;c<k.length;c++){var e=k[c];if(h!=e){var g=a.sub(h.a,e.a),t=h.b+e.b,l=a.g(g,g);if(!(l>t*t)){console.log("collision");if(h==p||e==p)console.log(p);f=h.e+e.e;l=Math.sqrt(l);g[0]/=l;g[1]/=l;g[2]/=l;e.a=a.sub(e.a,a.scale(g,l*e.e));h.a=a.add(h.a,a.scale(g,l*h.e));l=a.sub(h.a,h.d);c=a.sub(e.a,e.d);l=a.sub(l,c);g=a.scale(g,a.g(l,g));g=a.sub(l,g);g[0]/=
f;g[1]/=f;g[2]/=f;h.a=a.sub(h.a,a.scale(g,0.5*h.e));e.a=a.add(e.a,a.scale(g,0.5*e.e));return true}}}}}})("stage"),u=setInterval(function(){r.m(3.0E-4);r.o();r.l()},16);document.addEventListener("keydown",function(b){if(b.keyCode==27){clearInterval(u);console.log("execution stopped")}},false)})();
